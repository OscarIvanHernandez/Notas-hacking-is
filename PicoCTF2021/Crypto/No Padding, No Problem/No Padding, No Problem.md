# PicoCTF2021 Crypto
## Objetivo
Oracles can be your best friend, they will decrypt anything, except the flag's ciphertext. How will you break it? Connect with `nc mercury.picoctf.net 2671`.
## Pistas
What can you do with a different pair of ciphertext and plaintext? What if it is not so different after all...

## Solucion


┌─[oscar@oscar-parrot]─[~/crypto/2021/NoPaddingNoProblem]
└──╼ $python
Python 3.9.2 (default, Feb 28 2021, 17:03:44) 
[GCC 10.2.1 20210110] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from Crypto.Util.number import long_to_bytes
>>> n = 98608084663705685721763949440075224235223775001863083302183542971613143977610952131105064514858189261160400212987604801139990633766412224819129009002075740576282743888191947721342663408744812049123462749704347382705855066588019147980426679208605948004297830016409891969867220794693204201727449242762985097799
>>> e = 65537
>>> c =55890841406470922133693805832082043567429727927332547388091516246457228087848880038268663351596822705939789072976002695810976160868333195199938988464714444036755307163563886256928561064418112551680260491036729920824520863551632707530099210601811381661359025810526235161396543063464440714285376674265526086008
>>> 
>>> 
>>> x = pow(2,e,n)
>>> x
9715865766443221021568006959763343125794109605274401129395440388070488780824500608984625828454317288493357490973367855716526860986684986544705709794069117999860734071482135977656331748228290493413708129893255545628529497011157129941905705814037825198508348559520485376181404529963163460374264072113920572638
>>> c * x
543027912678838119057678828230989059707945737104316781389852038127995937826578316925041263680561877570475887196498763717707436416431314238493963437768230485915494508363875339339946928330332842032756926525222084547026604986190497270908634055494760959379208909872959644026512820597036411731768946218450514511201387869725282348622832355420574039246343050531841764657979493737308925542064033098085325743547204715803012532523997039989298981686844469106325982124030426257253579773460896226904649486241389925107403242802016500959706009984506811666767122438021125437389575068481771080901300437948127533433034356358199449104
>>> m = 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769430290200460554490
>>> m = 580550060391700078946913236734911770139931497702556153513487440893406629034802718534645538074938502890769430290200460554490 // 2
>>> long_to_bytes(m)
b'picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_5814368}'
>>> 

## Notas adicionales
c - texto cifrado
m - mensaje texto plano
p - primo 1
q - primo 2
n - modulo
tn - totient n (euler)
e - exponente (llave publica) 2^16+1=65537
d - llave privada

n = p * q
tn = (p-1) * (q-1)
d = e mod inv tn / inverse(e,tn)

Encriptar          : c = m^e mod n       / pow(m,e,n)
Desencriptar    : m = c^d mod n       / pow(c,d,n)s
## Referencias
https://www.youtube.com/watch?v=UN9M9Cby1zc&list=PLDo9DMLZyP6kTZ8Td37-LdbAx4-yNfHBl&index=45
